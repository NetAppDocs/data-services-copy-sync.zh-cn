---
sidebar: sidebar 
permalink: task-managing-relationships.html 
keywords: sync, immediate, now, schedule, minutes, hours, on, off, delete, group, accelerate, accelerating, grouping, multiple data brokers, sync now, turn off, turn on, sync schedule, settings, change settings, recently modified files, delete files on target, retries, retry, file types, exclude file type, include file type, delete relationship 
summary: 您可以随时通过立即同步数据、更改计划等来管理同步关系。 
---
= 在NetApp Copy and Sync 中管理同步关系
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
您可以随时通过立即同步数据、更改计划等来管理NetApp Copy and Sync 中的同步关系。



== 立即执行数据同步

您无需等待下一次预定的同步，而是可以立即在源和目标之间同步数据。

.步骤
. link:task-login-copyandsync.html["登录以复制和同步"] 。
. 从“仪表板”导航到同步关系并选择image:icon-sync-action.png["允许您对同步关系采取行动的按钮的屏幕截图"]
. 选择*立即同步*，然后选择*同步*进行确认。


.结果
复制和同步启动关系的数据同步过程。



== 加速同步性能

通过向管理关系的组添加额外的数据代理来加速同步关系的性能。附加数据代理必须是_新_数据代理。

.工作原理
如果数据代理组管理其他同步关系，那么您添加到该组的新数据代理也会加速这些同步关系的性能。

例如，假设您有三种关系：

* 关系 1 由数据经纪人组 A 管理
* 关系 2 由数据经纪人组 B 管理
* 关系 3 由数据经纪人组 A 管理


您想要加速关系 1 的性能，因此您向数据代理组 A 添加一个新的数据代理。由于组 A 还管理同步关系 3，因此关系的同步性能也会自动加速。

.步骤
. 确保关系中至少有一个现有数据代理处于在线状态。
. 从“仪表板”导航到同步关系并选择image:icon-sync-action.png["允许您对同步关系采取行动的按钮的屏幕截图"]
. 选择*加速*。
. 按照提示创建一个新的数据代理。


.结果
复制和同步将新的数据代理添加到组中。下一次数据同步的性能应该会加快。



== 更新凭据

您可以使用现有同步关系中的源或目标的最新凭据更新数据代理。如果您的安全策略要求您定期更新凭证，则更新凭证会有所帮助。

任何复制和同步需要凭证的源或目标都支持更新凭证：Azure Blob、Box、IBM Cloud Object Storage、 StorageGRID、 ONTAP S3 Storage、SFTP 和 SMB 服务器。

.步骤
. 从*同步仪表板*，转到需要凭据的同步关系，然后选择*更新凭据*。
+
image:screenshot_sync_update_credentials.png["屏幕截图显示了同步关系页面上源或目标名称下方的更新凭据选项。"]

. 输入凭证并选择*更新*。
+
关于 SMB 服务器的注意事项：如果域是新的，那么您需要在更新凭据时指定它。如果域名没有改变，则无需再次输入。

+
如果您在创建同步关系时输入了域，但在更新凭据时未输入新域，则复制和同步将继续使用您提供的原始域。



.结果
复制和同步会更新数据代理上的凭据。数据代理开始使用更新后的凭证进行数据同步可能需要 10 分钟。



== 设置通知

每个同步关系的*通知*设置使您可以选择是否在NetApp控制台的通知中心接收复制和同步通知。您可以启用数据同步成功、数据同步失败和数据同步取消的通知。

image:https://raw.githubusercontent.com/NetAppDocs/bluexp-copy-sync/main/media/screenshot-notification-center.png["显示NetApp控制台中的通知中心的屏幕截图。"]

此外，您还可以通过电子邮件接收通知。

.步骤
. 修改同步关系的设置：
+
.. 从“仪表板”导航到同步关系并选择image:icon-sync-action.png["允许您对同步关系采取行动的按钮的屏幕截图"]
.. 选择“设置”。
.. 启用*通知*。
.. 选择“保存设置”。


. 如果您想通过电子邮件接收通知，请配置警报和通知设置：
+
.. 选择*设置 > 警报和通知设置*。
.. 选择一个或多个用户并选择*信息*通知类型。
.. 选择*应用*。




.结果
如果您配置了该选项，您现在将在NetApp控制台的通知中心收到复制和同步通知，并通过电子邮件发送一些通知。



== 更改同步关系的设置

修改定义如何在目标位置同步和维护源文件和文件夹的设置。

. 从“仪表板”导航到同步关系并选择image:icon-sync-action.png["允许您对同步关系采取行动的按钮的屏幕截图"]
. 选择“设置”。
. 修改任何设置。
+
image:screenshot_sync_settings.png["显示同步关系设置的屏幕截图。"]

+
[[deleteonsource]] 以下是每个设置的简要说明：

+
计划:: 选择未来同步的重复计划或关闭同步计划。您可以安排每 1 分钟同步一次数据。
同步超时:: 定义如果同步在指定的分钟数、小时数或天数内未完成，复制和同步是否应取消数据同步。
通知:: 使您能够选择是否在NetApp控制台的通知中心接收复制和同步通知。您可以启用数据同步成功、数据同步失败和数据同步取消的通知。
+
--
如果您想接收以下通知

--
重试:: 定义复制和同步在跳过文件之前应重试同步文件的次数。
比较依据:: 选择在确定文件或目录是否已更改并应再次同步时，复制和同步是否应比较某些属性。
+
--
即使您取消选中这些属性，“复制和同步”仍会通过检查路径、文件大小和文件名将源与目标进行比较。如果有任何变化，那么它会同步这些文件和目录。

您可以通过比较以下属性来选择启用或禁用复制和同步：

** *mtime*：文件的最后修改时间。此属性对于目录无效。
** *uid*、*gid* 和 *mode*：Linux 的权限标志。


--
对象复制:: 创建关系后，您无法编辑此选项。
最近修改的文件:: 选择排除在预定同步之前最近修改的文件。
删除源文件:: 在“复制和同步”将文件复制到目标位置后，选择从源位置删除文件。此选项存在数据丢失的风险，因为源文件在复制后会被删除。
+
--
如果启用此选项，您还需要更改数据代理上的 local.json 文件中的参数。打开文件并进行如下更新：

[source, json]
----
{
"workers":{
"transferrer":{
"delete-on-source": true
}
}
}
----
更新 local.json 文件后，您应该重新启动： `pm2 restart all` 。

--
删除目标文件:: 如果文件已从源位置删除，则选择从目标位置删除文件。默认设置是从不从目标位置删除文件。
文件类型:: 定义每次同步中要包含的文件类型：文件、目录、符号链接和硬链接。
+
--

NOTE: 硬链接仅适用于不安全的 NFS 到 NFS 关系。用户将被限制为一个扫描仪进程和一个扫描仪并发，并且扫描必须从根目录运行。

--
排除文件扩展名:: 通过输入文件扩展名并按 *Enter* 来指定要从同步中排除的正则表达式或文件扩展名。例如，键入 _log_ 或 _.log_ 来排除 *.log 文件。多个扩展名不需要分隔符。以下视频提供了一个简短的演示：
+
--
.排除同步关系的文件扩展名
video::7f957dbf-9215-41ea-a705-b24c010b2212[panopto]

NOTE: Regex 或正则表达式与通配符或 glob 表达式不同。此功能*仅*适用于正则表达式。

--
排除目录:: 通过输入其名称或目录完整路径并按 *Enter*，指定最多 15 个要从同步中排除的正则表达式或目录。默认情况下，.copy-offload、.snapshot、~snapshot 目录被排除。
+
--

NOTE: Regex 或正则表达式与通配符或 glob 表达式不同。此功能*仅*适用于正则表达式。

--
文件大小:: 选择同步所有文件，无论其大小，或仅同步特定大小范围内的文件。
修改日期:: 选择所有文件，无论其最后修改日期如何，选择在特定日期之后、特定日期之前或某个时间范围内修改的文件。
创建日期:: 当 SMB 服务器作为源时，此设置使您能够同步在特定日期之后、特定日期之前或特定时间范围之间创建的文件。
ACL——访问控制列表:: 通过在创建关系时或创建关系后启用设置，从 SMB 服务器仅复制 ACL、仅复制文件或复制 ACL 和文件。


. 选择“保存设置”。


.结果
复制和同步会使用新设置修改同步关系。



== 删除关系

如果您不再需要在源和目标之间同步数据，您可以删除同步关系。此操作不会删除数据代理组（或单个数据代理实例），也不会从目标中删除数据。



=== 选项 1：删除单个同步关系

.步骤
. 从“仪表板”导航到同步关系并选择image:icon-sync-action.png["允许您对同步关系采取行动的按钮的屏幕截图"]
. 选择*删除*，然后再次选择*删除*进行确认。


.结果
复制并同步会删除同步关系。



=== 选项 2：删除多个同步关系

.步骤
. 从“仪表板”导航到“创建新同步”按钮并选择image:icon-sync-action.png["允许您对同步关系采取行动的按钮的屏幕截图"]
. 选择要删除的同步关系，选择*删除*，然后再次选择*删除*进行确认。


.结果
复制并同步会删除同步关系。
