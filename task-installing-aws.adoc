---
sidebar: sidebar 
permalink: task-installing-aws.html 
keywords: data broker, install, aws, networking, permissions, regions, install data broker in aws, install in aws, deploy in aws, deploy data broker in aws, cft, template, iam role, use your own iam role, regions, supported regions, networking requirements, port, ports, 443, port 443, ntp, network time protocol, permissions, iam role, iam permissions, aws data broker 
summary: 创建新的数据代理时，选择 AWS Data Broker 选项在 VPC 中的新 EC2 实例上部署数据代理软件。  NetApp Copy and Sync 将指导您完成安装过程，但此页面上重复了要求和步骤，以帮助您做好安装准备。 
---
= 在 AWS 中为NetApp Copy and Sync 创建新的数据代理
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
为NetApp Copy and Sync 创建新的数据代理组时，请选择 Amazon Web Services 在 VPC 中的新 EC2 实例上部署数据代理软件。  NetApp Copy and Sync 将指导您完成安装过程，但此页面上重复了要求和步骤，以帮助您做好安装准备。

您还可以选择在云端或本地的现有 Linux 主机上安装数据代理。link:task-installing-linux.html["了解更多"] 。



== 支持的 AWS 区域

除中国地区外，所有地区均受支持。



== Root权限

数据代理软件在 Linux 主机上自动以 root 身份运行。以 root 身份运行是数据代理操作的必要条件。例如，挂载共享。



== 网络要求

* 数据代理需要出站互联网连接，以便它可以通过端口 443 轮询复制和同步任务。
+
当 Copy and Sync 在 AWS 中部署数据代理时，它会创建一个安全组来启用所需的出站通信。请注意，您可以在安装过程中配置数据代理以使用代理服务器。

+
如果需要限制出站连接，请参阅link:reference-networking.html["数据代理联系的端点列表"]。

* NetApp建议配置源、目标和数据代理以使用网络时间协议 (NTP) 服务。三个组件之间的时间差不应超过5分钟。




== 在 AWS 中部署数据代理所需的权限

用于部署数据代理的 AWS 用户帐户必须具有以下权限： https://s3.amazonaws.com/metadata.datafabric.io/docs/aws_iam_policy.json["NetApp提供的政策"^] 。



== [[iam]]将您自己的 IAM 角色与 AWS 数据代理结合使用的要求

当 Copy and Sync 部署数据代理时，它会为数据代理实例创建一个 IAM 角色。如果您愿意，您可以使用自己的 IAM 角色部署数据代理。如果您的组织有严格的安全策略，您可以使用此选项。

IAM 角色必须满足以下要求：

* 必须允许 EC2 服务作为受信任实体承担 IAM 角色。
* link:media/aws_iam_policy_data_broker.json["此 JSON 文件中定义的权限"^]必须附加到 IAM 角色，以便数据代理可以正常运行。


按照以下步骤在部署数据代理时指定 IAM 角色。



== 创建数据代理

有几种方法可以创建新的数据代理。这些步骤描述了如何在创建同步关系时在 AWS 中安装数据代理。

.步骤
. link:task-login-copyandsync.html["登录以复制和同步"] 。
. 选择*创建新同步*。
. 在*定义同步关系*页面上，选择源和目标，然后选择*继续*。
+
完成这些步骤，直到到达*数据经纪人组*页面。

. 在*数据代理组*页面上，选择*创建数据代理*，然后选择*Amazon Web Services*。
+
image:screenshot-aws.png["数据代理页面的屏幕截图，可让您在 AWS、Azure、Google Cloud 和 On-Prem 数据代理之间进行选择。"]

. 输入数据代理的名称并选择*继续*。
. 输入 AWS 访问密钥，以便 Copy and Sync 可以代表您在 AWS 中创建数据代理。
+
密钥不会被保存或用于任何其他目的。

+
如果您不想提供访问密钥，请选择页面底部的链接以使用 CloudFormation 模板。当您使用此选项时，您不需要提供凭证，因为您直接登录到 AWS。

+
[[cft]]以下视频展示了如何使用 CloudFormation 模板启动数据代理实例：

+
.从 AWS CloudFormation 模板启动数据代理
video::abaf0898-ea15-4f84-938e-b24c010b21e8[panopto]
. 如果您输入了 AWS 访问密钥，请选择实例的位置、选择密钥对、选择是否启用公共 IP 地址并选择现有的 IAM 角色，或者将字段留空，以便复制和同步为您创建角色。您还可以选择使用 KMS 密钥加密您的数据代理。
+
如果您选择自己的 IAM 角色，<<iam,您需要提供所需的权限>> 。

+
image:screenshot_aws_data_broker.png["在 AWS 中部署数据代理时需要提供的信息的屏幕截图。"]

. 如果 VPC 中的互联网访问需要代理，请指定代理配置。
. 数据代理可用后，在复制和同步中选择*继续*。
+
下图显示了 AWS 中成功部署的实例：

+
image:screenshot-data-broker-group-selected.png["此屏幕截图显示了已成功部署的实例。该界面显示有关实例的详细信息，包括 AWS 网络。"]

. 完成向导中的页面以创建新的同步关系。


.结果
您已在 AWS 中部署了数据代理并创建了新的同步关系。您可以将此数据代理组与其他同步关系一起使用。



== 有关数据代理实例的详细信息

复制和同步使用以下配置在 AWS 中创建数据代理。

Node.js 兼容性:: v21.2.0
实例类型:: 如果该地区可用，则使用 m5n.xlarge，否则使用 m5xlarge
虚拟 CPU:: 4
RAM:: 16 GB
操作系统:: 亚马逊Linux 2023
磁盘大小和类型:: 10 GB GP2 固态硬盘

